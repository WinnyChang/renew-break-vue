(function(){"use strict";console.log("Worker initialized");let a={eyeRest:{timerLength:null,startAt:null,pausedAt:null,totalPausedTime:0},standUp:{timerLength:null,startAt:null,pausedAt:null,totalPausedTime:0},break:{timerLength:null,startAt:null,pausedAt:null,totalPausedTime:0}},i=null;self.onmessage=function(n){const{action:l,data:t}=n.data,e=a[t.timerType];switch(l){case"start":e.timerLength=t.timerLength,e.startAt?e.pausedAt&&(e.totalPausedTime+=Date.now()-e.pausedAt,e.pausedAt=null):(e.startAt=Date.now(),e.totalPausedTime=0),i||(console.log("Starting check interval"),i=setInterval(()=>r(),500));break;case"pause":e.pausedAt=Date.now();break;case"reset":Array.isArray(t.timerType)?t.timerType.forEach(s=>{a[s].startAt=null,a[s].timerLength=null,a[s].pausedAt=null,a[s].totalPausedTime=0}):(a[t.timerType].startAt=null,a[t.timerType].timerLength=null,a[t.timerType].pausedAt=null,a[t.timerType].totalPausedTime=0);break}};function r(){const n=Date.now();Object.entries(a).forEach(([l,t])=>{if(t.timerLength&&t.startAt&&!t.pausedAt){const e=n-t.startAt-t.totalPausedTime,s=Math.max(0,t.timerLength-e);if(self.postMessage({type:"tick",timerType:l,remaining:s}),s===0){const u=new Intl.DateTimeFormat("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(n).replace(",","");console.log(l,"timer completed"),self.postMessage({type:"complete",timerType:l,time:u}),t.startAt=null,t.totalPausedTime=0;return}}})}})();
